---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { Calendar, User, ArrowLeft, Tag } from 'lucide-astro';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

const formatDate = (date: Date) => {
	return date.toLocaleDateString('zh-CN', {
		year: 'numeric',
		month: 'long',
		day: 'numeric',
	});
};
---

<Layout title={`${post.data.title} | 上海皓戴技术专栏`} keywords={post.data.tags.join(', ')}>
  <!-- Article Header -->
  <header class="relative py-20 bg-slate-900 overflow-hidden">
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_var(--tw-gradient-stops))] from-slate-800 via-slate-900 to-slate-900"></div>
    
    <div class="relative z-10 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <a href="/haodell/knowledge" class="inline-flex items-center text-slate-400 hover:text-white mb-8 transition-colors group">
        <ArrowLeft class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" />
        返回知识库
      </a>
      
      <div class="flex flex-wrap gap-2 mb-6">
        {post.data.tags.map(tag => (
          <span class="px-3 py-1 text-sm font-medium bg-blue-500/20 text-blue-300 border border-blue-500/30 rounded-full">
            #{tag}
          </span>
        ))}
      </div>

      <h1 class="text-3xl md:text-5xl font-bold text-white mb-8 leading-tight">
        {post.data.title}
      </h1>

      <div class="flex items-center text-slate-400 text-sm gap-6">
        <div class="flex items-center">
          <User class="w-4 h-4 mr-2" />
          {post.data.author}
        </div>
        <div class="flex items-center">
          <Calendar class="w-4 h-4 mr-2" />
          {formatDate(post.data.pubDate)}
        </div>
      </div>
    </div>
  </header>

  <!-- Article Content -->
  <article class="py-16 bg-theme-bg min-h-screen">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="bg-theme-surface rounded-2xl p-8 md:p-12 border border-slate-200 dark:border-slate-800 shadow-sm">
        <div class="prose prose-lg prose-slate dark:prose-invert max-w-none">
          <Content />
        </div>
      </div>

      <!-- CTA -->
      <div class="mt-12 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/50 rounded-2xl p-8 flex flex-col md:flex-row items-center justify-between gap-6">
        <div>
          <h3 class="text-xl font-bold text-blue-900 dark:text-blue-100 mb-2">遇到类似的硬件难题？</h3>
          <p class="text-blue-700 dark:text-blue-300">我们的工程师团队随时待命，为您提供原厂级技术支持。</p>
        </div>
        <a href="/haodell/#contact" class="px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-colors shadow-lg shadow-blue-500/20 whitespace-nowrap">
          联系技术支持
        </a>
      </div>
    </div>
  </article>
</Layout>